# ğŸ¤– AgentåŸºç¡€æ¦‚å¿µ

> **å­¦ä¹ ç›®æ ‡**ï¼šç†è§£AI Agentçš„æ ¸å¿ƒæ¦‚å¿µå’Œå·¥ä½œåŸç†

---

## 1. ä»€ä¹ˆæ˜¯AI Agentï¼Ÿ

**AI Agentï¼ˆæ™ºèƒ½ä½“ï¼‰** = LLM + æ„ŸçŸ¥ + æ€è€ƒ + è¡ŒåŠ¨

```
ä¼ ç»ŸLLM:  è¾“å…¥ â†’ å¤„ç† â†’ è¾“å‡º   (ä¸€æ¬¡æ€§)

AI Agent: æ„ŸçŸ¥ â†’ æ€è€ƒ â†’ è¡ŒåŠ¨ â†’ è§‚å¯Ÿ â†’ æ€è€ƒ â†’ è¡ŒåŠ¨ â†’ ... (å¾ªç¯)
```

### Agent vs æ™®é€šLLMè°ƒç”¨

| ç‰¹æ€§ | æ™®é€šLLM | AI Agent |
|------|---------|----------|
| äº¤äº’ | å•è½® | å¤šè½®è‡ªä¸» |
| å·¥å…· | æ—  | å¯è°ƒç”¨å·¥å…· |
| å†³ç­– | ç›´æ¥å›ç­” | è§„åˆ’+æ‰§è¡Œ |
| è‡ªä¸»æ€§ | ä½ | é«˜ |

---

## 2. Agentæ ¸å¿ƒç»„ä»¶

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              AI Agent               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
â”‚  â”‚  LLM    â”‚  â”‚  Memory â”‚          â”‚
â”‚  â”‚ (å¤§è„‘)  â”‚  â”‚ (è®°å¿†)  â”‚          â”‚
â”‚  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜          â”‚
â”‚       â”‚            â”‚                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”          â”‚
â”‚  â”‚      Reasoning       â”‚          â”‚
â”‚  â”‚      (æ¨ç†å¼•æ“)       â”‚          â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
â”‚             â”‚                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
â”‚  â”‚       Tools          â”‚          â”‚
â”‚  â”‚  (å·¥å…·/èƒ½åŠ›)         â”‚          â”‚
â”‚  â”‚  - æœç´¢              â”‚          â”‚
â”‚  â”‚  - è®¡ç®—              â”‚          â”‚
â”‚  â”‚  - ä»£ç æ‰§è¡Œ          â”‚          â”‚
â”‚  â”‚  - APIè°ƒç”¨           â”‚          â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2.1 LLMï¼ˆå¤§è„‘ï¼‰
- ç†è§£ç”¨æˆ·æ„å›¾
- è§„åˆ’ä»»åŠ¡æ­¥éª¤
- ç”Ÿæˆå›ç­”

### 2.2 Toolsï¼ˆå·¥å…·ï¼‰
- æœç´¢å¼•æ“
- è®¡ç®—å™¨
- ä»£ç æ‰§è¡Œ
- æ•°æ®åº“æŸ¥è¯¢
- APIè°ƒç”¨

### 2.3 Memoryï¼ˆè®°å¿†ï¼‰
- çŸ­æœŸè®°å¿†ï¼šå½“å‰å¯¹è¯
- é•¿æœŸè®°å¿†ï¼šå†å²ç»éªŒ

### 2.4 Reasoningï¼ˆæ¨ç†ï¼‰
- ä»»åŠ¡åˆ†è§£
- æ­¥éª¤è§„åˆ’
- ç»“æœæ•´åˆ

---

## 3. Agentå·¥ä½œæµç¨‹

```python
"""
ç»å…¸Agentå¾ªç¯
"""

def agent_loop(task: str):
    # åˆå§‹åŒ–
    observations = []
    
    while True:
        # 1. æ€è€ƒï¼šä¸‹ä¸€æ­¥è¯¥åšä»€ä¹ˆï¼Ÿ
        thought = llm.think(task, observations)
        
        # 2. å†³ç­–ï¼šé€‰æ‹©åŠ¨ä½œ
        action = llm.decide(thought)
        
        if action == "finish":
            # ä»»åŠ¡å®Œæˆ
            return llm.generate_answer(task, observations)
        
        # 3. æ‰§è¡Œï¼šè°ƒç”¨å·¥å…·
        result = execute_tool(action)
        
        # 4. è§‚å¯Ÿï¼šè®°å½•ç»“æœ
        observations.append(result)
```

---

## 4. ç®€å•Agentç¤ºä¾‹

```python
from openai import OpenAI
import json
import os

class SimpleAgent:
    """æœ€ç®€å•çš„Agentå®ç°"""
    
    def __init__(self):
        self.client = OpenAI(
            api_key=os.getenv("DEEPSEEK_API_KEY"),
            base_url="https://api.deepseek.com/v1"
        )
        
        # å®šä¹‰å¯ç”¨å·¥å…·
        self.tools = {
            "calculator": self.calculator,
            "search": self.search,
        }
    
    # ===== å·¥å…·å®šä¹‰ =====
    
    def calculator(self, expression: str) -> str:
        """è®¡ç®—æ•°å­¦è¡¨è¾¾å¼"""
        try:
            result = eval(expression)
            return f"è®¡ç®—ç»“æœ: {result}"
        except:
            return "è®¡ç®—é”™è¯¯"
    
    def search(self, query: str) -> str:
        """æ¨¡æ‹Ÿæœç´¢ï¼ˆå®é™…åº”è°ƒç”¨æœç´¢APIï¼‰"""
        # æ¨¡æ‹Ÿæœç´¢ç»“æœ
        fake_results = {
            "FastAPI": "FastAPIæ˜¯é«˜æ€§èƒ½Python Webæ¡†æ¶ï¼Œæ€§èƒ½æ¥è¿‘Goè¯­è¨€",
            "Python": "Pythonæ˜¯ä¸€ç§å¹¿æ³›ä½¿ç”¨çš„ç¼–ç¨‹è¯­è¨€",
        }
        for key, value in fake_results.items():
            if key.lower() in query.lower():
                return value
        return "æœªæ‰¾åˆ°ç›¸å…³ä¿¡æ¯"
    
    # ===== Agentæ ¸å¿ƒé€»è¾‘ =====
    
    def run(self, task: str, max_steps: int = 5) -> str:
        """æ‰§è¡ŒAgentä»»åŠ¡"""
        
        messages = [
            {"role": "system", "content": """ä½ æ˜¯ä¸€ä¸ªæ™ºèƒ½åŠ©æ‰‹ã€‚ä½ å¯ä»¥ä½¿ç”¨ä»¥ä¸‹å·¥å…·ï¼š

1. calculator(expression): è®¡ç®—æ•°å­¦è¡¨è¾¾å¼
2. search(query): æœç´¢ä¿¡æ¯

å›å¤æ ¼å¼ï¼š
- å¦‚æœéœ€è¦ä½¿ç”¨å·¥å…·ï¼š{"action": "å·¥å…·å", "input": "å‚æ•°"}
- å¦‚æœå¯ä»¥ç›´æ¥å›ç­”ï¼š{"action": "finish", "answer": "æœ€ç»ˆç­”æ¡ˆ"}

è¯·ä¸€æ­¥ä¸€æ­¥æ€è€ƒï¼Œç„¶åå†³å®šä¸‹ä¸€æ­¥è¡ŒåŠ¨ã€‚"""},
            {"role": "user", "content": task}
        ]
        
        for step in range(max_steps):
            # è°ƒç”¨LLMå†³ç­–
            response = self.client.chat.completions.create(
                model="deepseek-chat",
                messages=messages,
                temperature=0
            )
            
            reply = response.choices[0].message.content
            print(f"[Step {step + 1}] Agentæ€è€ƒ: {reply}")
            
            # è§£æåŠ¨ä½œ
            try:
                action = json.loads(reply)
            except:
                # å¦‚æœä¸æ˜¯JSONï¼Œå°è¯•æå–
                if "finish" in reply.lower():
                    return reply
                continue
            
            # æ£€æŸ¥æ˜¯å¦å®Œæˆ
            if action.get("action") == "finish":
                return action.get("answer", reply)
            
            # æ‰§è¡Œå·¥å…·
            tool_name = action.get("action")
            tool_input = action.get("input", "")
            
            if tool_name in self.tools:
                result = self.tools[tool_name](tool_input)
                print(f"[Step {step + 1}] å·¥å…·ç»“æœ: {result}")
                
                # æ·»åŠ ç»“æœåˆ°å¯¹è¯
                messages.append({"role": "assistant", "content": reply})
                messages.append({"role": "user", "content": f"å·¥å…·è¿”å›: {result}\nè¯·ç»§ç»­ã€‚"})
            else:
                messages.append({"role": "user", "content": f"æœªçŸ¥å·¥å…·: {tool_name}"})
        
        return "è¾¾åˆ°æœ€å¤§æ­¥éª¤æ•°ï¼Œä»»åŠ¡æœªå®Œæˆ"

# ä½¿ç”¨
if __name__ == "__main__":
    agent = SimpleAgent()
    
    # æµ‹è¯•è®¡ç®—
    result = agent.run("è®¡ç®— (15 + 27) * 3 çš„ç»“æœæ˜¯å¤šå°‘ï¼Ÿ")
    print(f"\næœ€ç»ˆç­”æ¡ˆ: {result}")
    
    # æµ‹è¯•æœç´¢
    result = agent.run("FastAPIçš„æ€§èƒ½æ€ä¹ˆæ ·ï¼Ÿ")
    print(f"\næœ€ç»ˆç­”æ¡ˆ: {result}")
```

---

## 5. Agentç±»å‹

### 5.1 ReAct Agent
```
æ€è€ƒ(Reasoning) â†’ è¡ŒåŠ¨(Acting) â†’ è§‚å¯Ÿ(Observing) â†’ å¾ªç¯
```

### 5.2 Plan-and-Execute Agent
```
1. åˆ¶å®šå®Œæ•´è®¡åˆ’
2. é€æ­¥æ‰§è¡Œè®¡åˆ’
3. æ ¹æ®ç»“æœè°ƒæ•´
```

### 5.3 Self-Reflection Agent
```
æ‰§è¡Œ â†’ åæ€ç»“æœ â†’ æ”¹è¿›æ–¹æ³• â†’ é‡æ–°æ‰§è¡Œ
```

### 5.4 Multi-Agent
```
å¤šä¸ªä¸“ä¸šAgentåä½œå®Œæˆå¤æ‚ä»»åŠ¡
```

---

## 6. Agentåº”ç”¨åœºæ™¯

| åœºæ™¯ | æè¿° |
|------|------|
| è‡ªåŠ¨åŒ–åŠ©æ‰‹ | è‡ªåŠ¨å®Œæˆé‚®ä»¶ã€æ—¥ç¨‹ç®¡ç† |
| ä»£ç åŠ©æ‰‹ | è‡ªåŠ¨ç¼–å†™ã€è°ƒè¯•ä»£ç  |
| æ•°æ®åˆ†æ | è‡ªåŠ¨åˆ†ææ•°æ®ã€ç”ŸæˆæŠ¥å‘Š |
| å®¢æˆ·æœåŠ¡ | è‡ªåŠ¨å¤„ç†å®¢æˆ·é—®é¢˜ |
| ç ”ç©¶åŠ©æ‰‹ | è‡ªåŠ¨æœç´¢ã€æ•´ç†èµ„æ–™ |

---

## ğŸ“º æ¨èBç«™è§†é¢‘

æœç´¢ï¼š
- **"AI Agent å…¥é—¨æ•™ç¨‹"**
- **"æ™ºèƒ½ä½“ åŸç†è®²è§£"**
- **"LLM Agent å¼€å‘"**

---

## 7. ç»§ç»­å­¦ä¹ 

ğŸ“Œ **Week 6 å­¦ä¹ é¡ºåº**ï¼š
1. âœ… AgentåŸºç¡€æ¦‚å¿µï¼ˆæœ¬æ•™ç¨‹ï¼‰
2. â¡ï¸ ReActæ¡†æ¶å®ç°
3. â¡ï¸ å·¥å…·ä½¿ç”¨è¯¦è§£
4. â¡ï¸ å¤šAgentç³»ç»Ÿ

---

**Agentè®©LLMçœŸæ­£æ‹¥æœ‰è¡ŒåŠ¨èƒ½åŠ›ï¼ğŸ’ª**
